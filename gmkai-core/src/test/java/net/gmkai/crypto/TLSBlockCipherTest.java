package net.gmkai.crypto;

import net.gmkai.ContentType;
import net.gmkai.ProtocolVersion;
import net.gmkai.TLSText;
import net.gmkai.crypto.impl.bc.BcTLSCrypto;
import net.gmkai.util.Hexs;
import org.junit.Test;

import java.io.IOException;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.is;

public class TLSBlockCipherTest {

    TLSCryptoParameters parameters = TLSCryptoParameters.TLSCryptoParametersBuilder.aTLSCryptoParameters()
            .withSelfCryptoKey(Hexs.decode("54947edabf3982aa11fd7612c0aa7967"))
            .withSelfCryptoKeyIv(Hexs.decode("e3d5032242c14c1fbd52313959a1fff5"))
            .withSelfMacKey(Hexs.decode("2e5c1c7962547d9764b9a3744ecd907df4a70b9f6e2030605150a793b59823ea"))
            .withPeerCryptoKey(Hexs.decode("863cb52fbac47f9d1b7b825db7ca269f"))
            .withPeerCryptoIv(Hexs.decode("a9850b81abf358798ad4bb23e8f8966a"))
            .withPeerMackey(Hexs.decode("b0f892b9f616c0bf93daa9fb64a34b312deb0c6a30f6b7fd87c41901778453c4"))
            .withBulkCipherAlg(BulkCipherAlg.SM4_CBC)
            .withMacAlg(MacAlg.M_SM3)
            .build();

    byte[] acceptedFragment = ("HTTP/1.1 200 OK\r\n" +
            "Server: TLCP/1.1\r\n" +
            "Content-Length:" + 12 + "\r\n" +
            "Content-Type: text/plain\r\n" +
            "Connection: close\r\n\r\n").getBytes();

    byte[] acceptedEncryptedFragment = Hexs.decode("415751d379584541f51d4de53a8b5abe4b74618c8f68987a8fe853d149c6187348bf2e87fcba83c2250512cac4f16cb6b81f7e01f6e5653cf042fdd8c02c639f33d660f6049fb98e3e4e05d7b292f81872868da76bcf49f49657e4f51ceede5fe7bb9c1e9fedb9b1951e0616d4f1f008b1b9f02ef9fb9afdcad0f1824c5b28b924eb12a5edf84df8fe192ffefae2c6237a2bf1d1afe0d885ced7f24d16b2712a");

    final private TLSText acceptedEncryptedText = new TLSText(
            ContentType.APPLICATION_DATA,
            ProtocolVersion.TLCP11,
            acceptedEncryptedFragment);

    final private TLSText acceptedPlainText = new TLSText(
            ContentType.APPLICATION_DATA,
            ProtocolVersion.TLCP11,
            acceptedFragment);

    byte[] sentFragment = ("GET / HTTP/1.1\r\n" +
            "User-Agent: Java/1.8.0_221\r\n" +
            "Host: localhost:8443\r\n" +
            "Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\n" +
            "Connection: keep-alive\r\n" +
            "\r\n" +
            "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0")
            .getBytes();

    byte[] sentEncryptedFragment = Hexs.decode("f5d5ef969e5cafff3db35d0a3f0840ad1fcac8d3678624619994baebf160dc5dc92cae129bb9c1b6f8f6a12c2ca72ef173da7273bc78e468912797f3bcf97314eba16c8adf239c4efcda73f90a6485ebc3cd1fae360dc1a95938c31f293a7b9e6b8688693c6eb317431f15a1d9d855c0ea06a4d97a68675bb46257a76d9a2c38daf36d9a38458d7d51dbe32bc81c22f3b1a7985251a8c31ee859a707cc53d5179b4c3ae16af2e87f43c3fbf2eb3cb7f9715cc362f6554b03a16b0ff037152186b76d18a5e137d91964f77a257bc212e1e8516f61d031a76095da575f269860b28815786267bd77d5bac67042a4a321182c6c837c84f8e76093b0f1dc6add7be57aba3539edde44950370a8e4fbddbd72d98194b62e8263ed2633633edb2637fdf1d8a9ce165d33be078c37f3bc5e300c74beb6ebd2d1f5e09a725d36a226286c7bcb5c888bba1a104888b1faadf3257245e31c88999283f6d2d3173dd565e3530eb1134f7000dade0ce3aec3297aa7a62f96b8ae303eecdcf0e4a5abe645933ac0c4b935a6f397c70b9fa9f28e412cc69078eb1fd482dfbcb72a2683972b5450e730ae005f734afdb324512b39cf716e27c358f832fcdfb68bad2c0a26b0983ac467379c03371daa27840ba9870d949cb69bda57237b5c76ca3d5b581b5cbaaaa52724780b03758d39c84c14c0799405ef997be7a7d3f31e53ef5eb84978bd1a102a4c08866cec7c81f790dcdf1b8d64d33cb654257e0d4d2c865f9fcbac93dc65fa351e756b6110fcccb50898492e9b44a5a66a962d86d0b9521bf06c72b59d4ce9ee25dcd80234e09b0ca0e1aa12a7671280fc04e4e85f809e821ce1c24b13e9e060c34b627e9e0aad1f75df503edb4d5330cd9a338c03a9310d6046b19bf6753e8773250db74ea351369dcd79387e7b96265d6d3afcad0066bcb05fd805bb243a29aa17f4f2630b0c5a89fbc6bac1adcfad82090634650783303ebdcd192a7ca994c8bd133624686877a69afd72cfebe724bcea90499484d2501ec00d1799c85b6c6173be98f2633964705f6fb97c67182e71398b7d5998cd154828d2e5c98eba5edf86911ef72e696dce72c6a6fc963e4e9cff1a69eec18418e80cadcc7c5055125d988fc3a0ff2880b7f67efb4d93c9300d1bb9c6c5a5b1848191ccabc64c3141d59e1a6ef45dee69fd2ba14e83dfe8f01333cb0b28376cba4a6091577e8065559c949994212b608d0be7adfd89c7c2455cfeb651ea15922569cd04c6e2dc7592ccb431fbbd2862a19b604e9a6b8485f34593cc1b744957c86e2673e64d4ea232d2807b962f16ef21fe137dd9a2c01084078c751d2c778b918e9d9ccda40e20fe4cf5cdced5d3927fb50cd418fe09bd313a8e0835e501ba264867af5e330f17debd32dcef5069e6cdf2d876ddf1f1240ff10c5f8d78936ecdf17c66e32a621c40f033ec19420e7240e70308907a9f023ab64dc7e8043366f705b524236ffd09af9990dc2f5609d41ddd0a3dde4a724d862ef39c97ab56c97f345b98017e646401d896067fe09af95cbcb28e823f7f9bc32a6e1183a1eb535f593a3f1e84e8074673658e81823e9d52f74891d12a049427558dce423598bd472be45765e4ad128f28f420e5c9749b93b22e9aa8d6742821d896c3082cfb88cf8a511e0cbcb4b9d6faf68e8840ab737c9b2fee4aa3d596358b0938ca9986b5a4e7ec3add8b9f18519e0b9b0519dd1916ed079b3e3fc7a3f003106195b848d491594d16e1deb56d8766468c520d2fb855189265a187aec43875434189ffb12438317b8dcd76fb191b972dc7ae86342a09086f355fbfe1b3d4e0f21d499e45c80a43a9d14e6fa6bd80e2d58b745f0d1e6c4d39e73e7217426833f5e161e5c96de0ecb0a5dcffe3d8c3e4c912f92173cce6f4754fb6ee1165b5c98d92615e9699c80b64d0a1865d16b8fabbb7d0251fbc6bc9d1cfd3a89ccf99c77ba396499901b393ab96f2df561f69eb8a0b71fb982a830247991f41ee4b25621ed0134744cbc8235d766eb93309f0a59524dcfe7a870fb1130cc97389a0bdc4de337a7f1f9e1ff7ca6295e066362654cf03f2ec0cbd4062376c8ea48452a798178fe34583aaf5b43f42db42a8d0222bf1a9ef8b2b1029543076384262bc2f33834a56d9baa5e67415f832d39cc79bcbdc1802759591cac77659f98715966f8dcda60bfa5c551b2fa05d5ae36c180912d25103b00b0962f4ee5f6d58a300b5c62807123695ec180996a101756f3484e677402ab6163a91d20b4675c4a3b688167edf71852e8ebb2562f87c16dd9001d09759686678db963cf90b18d52749ec0749ffe59187517c9d8899347cf2ca8d21870efab971d3534ee6dac21a93049d1aee55bedb79a3a37547cb8d73b1cc3b8b163d3961dcdea953f1ce75333d1c2f2542702458bd8fbcb3cce3463dde1c534e11fc198ccabec679bab2cd44b2cd5c45cfcfc02c742c2876bb4590d4224b684e946252343786416812abb0958388ee62886e3de631f64b75db1f16ce33c04c42364783cf558af8e56351aae9031e9085f83675cfd99d16b6860fadd678f0eea72537dacbf9714ee1a1e6c84e1d1dab34e944381cbe5a8fb3014f215c9498cf94e25090df8eeb28dace317c4209ce0429cf763bf39afd5ca6dcc3d574a9b0f272d1392956b67d4e20cdc5e427a7349217e2646ec89095b051941a4d40a34188e5ddd8f9f574bfc53528d4ffca8620d95127f4836366a5f94f1a5ea304ace3d334e86331bbc0366ec9342c016f093eae7498e9ffacd7b7d117b9d94f7abe1bb2e6225a47636661ca14cd0e6163392aa43fea50e6d9b95cdc27afa4ec7080ee4961a87943cb93d25b1aafcf0c5d9a22af2fd184fde643e3ebf153bb1efeee5cadbe9a85e9c92247b1de08b1d2a384a3e30cd2ff6f1a79ef91a895358d0bc91ea4f44dd7fc18f43d365333357cd6ed017dad50212a6f55b8d8cd3646831c583723aa49f56f3798e03d2b55ae47d8da9ff5bfc6eca805939dda3e911b42553ab4f4955b7e362723d1156719ab2529a8c94d90b7ece2e175ac0ca5ad8160e8dac3557ba5d891c34a43a9d5c3ee57bc77e7ee8ad75afe2d2c329f9564e3abfc83e8c3436b570e31fc3a61855293b30eefad3fe544a9491252d30af36db708b3dc06a6430106055ad89848d3e741e8ab51d0676aa8cf8c6f3878d5c057fc426afe9b76a383d9c0810e9467d1288da7568382dc0d25c394e24bf90500c442163fedb9f3c72b066b11a2e57c9d9dc80b295e7d29ed353cc0de251fd8f68ee033034208db6b0d946f2fbfa375efe271f648b02fc8ca85173f3663cb7cf964d02deb2f8672f913b07ac33f2beb097e80a1bba3137408ae692530cb9110c27cb6cb295d4a257d2a305e77f1711a97dcfdc1b9b36abdf4e2c0226ba7a5a0f910ecf061deb43a56304dd8258c018b7cfc626242886234409639183fe609a5604500d1f2197c8d623fb1554082e36429fa4648fc43466b3966a9f655c564fb8488910a0137e771d8ec089b61904628e954866dd99baf6b54c8b0b2b919d64accee4568116c7244ae993d31a6af5ece14b21a08eabc29b8b8af6808a1a4541104fbf088ab1456f9d8b5d127e8a672317e503481cbb2ebb642a2cf94fe4be0fc71227790f926033bc7b2425a285325bb54c03d432ffec2b4e6d416be7ac843b894110b4338d2d62ca0e6a70f73a419ddf44da4f2c3955a3e393bc520db28d85044f2838fd8841f47fe41e72466de298d672aeaf9319767c00517608cb14326e3d3a0d987abee1062184ef7b5e3a4482260c1e17b1ff21f6fda26170f49403f55e3d7aa5fa99fe703d57e2385e224fe572c735f281a4d1bb8dcee846daea7e0efb43a2c17dcd0607270d25676f9beb67571665071f2fed1f382b13065a69b782da93a9670bc9ebba93c9e0322b60388fc07fcabc9ea18974a026eb6a5276a7fc1fec5b3a1bbb2da0c39962631a2b78fafd585c2d4531ac5b1bfbe6656a2c0640ba7ef09cf593cbe029b8af03fc3c71975fd556e8bffddec45ac2704ce69a2c1ccd86a15f00d5884536043d6a441d67d793bf9e35ea3962d1162c9527fce324dbce55a81d40a79ee4453b103a8261b09351b9257ea5ae026c02a720198fb7cd803cbdeff7e90f657a985953012624c476836b5022e3a81611b05513cd7c86d9e2339d1ff97b91912767b480065208c67ad0048369d4c133d9cdcd4a648ae28c075ae72c5e253abcf719d4c69e1412023e2420a99944eef344703eb0d487080467336a9240db8d3ee9ac5dd46a562fc35c98bb2bc5b0f5f2b7a6b6ee325a6cfe9ea14e56051d8a2060a506297cc9c072c0d5dc1665f1522576dfdde2f1df7c87a607fa991f72e9b4a588e1d89976fa425a70b7b69563bb4cc2f363c58d409930ffbf6085a87ba99c414939950c1b989b310bcf6ad25be641d3dc4ab376f86d33d673205480dd2641ce7fed19b7330d7089398ae6df482337ff6e8efd32af4bc8a683e2b8d58cb2b557c0492f59b0aef2a41f2c504df4d626157b22dd7b47384834c7a6bd2ee01489ddaa1238e7fce0b0e8ccfccbe8c1d60990617e2b6b542fbd8e46fbab6009c1a347e044b3fc6cf30b6d3840c2d1f97da5f3390a8332bd5d9d88202b5433bdc1625688abfe0f9bb5ebdc7fe7c641184aaae3969ef31b130f2cc345c4352e5ecb16ff3d16fc1b6df2046d78c0790d72c7d439355996ee26eca98607bb5803106e3e93573a841b782ed0b0d69b69541d6fd911949474ad39bad6eeb74eeba27453e3a87a321a4a79580c84fd5727f1b981863dc5cd9d1da849b1bfebf9252caeea4737c0510e6d85010df539b82a9fe2d9ece593e7b9745874d0561645c8169df4bd407f6d4f1280c2f39470b0c9f0612ff4c530d377f19381c457157c6da3b8750a5b0c88258f77441a866ac07230c25ea3c11d54c7c5b4d94cad08f771c46501fbe4b07f6ff7673ec5e4a1320957202e44fb452046504a7ba931b2efa5ff67fbed83ecbe3500971068d97444aeba9c631a7f989230ed48b1a580361fe16df10e628efa2551a80366ea931ee9332fc460bf3fb8ed01de1e85fb660abce97417cad47806a16fd3ea67d6fd744138fed49d13fd6514a3bf362d6ec6c28e77ab459913a0e38aba4af52c00a394f898f729fc7132a5d0a46f9032bd6a0acb5c15401130393682763858afa66d1509818eb44f7e943c2e37427886313cac96666b7abd4520039873e82ebfbd8bff6d61a5153a6b7dfdbef7815e5b31ff3da05ef3d7e52a40ccaa52d4766e84aefc490736dd593d787953b41a1f64867b2bfa946c9a7689a30a03886ea1c8e66cb881df8e91dc8d7361626afb1a3200b26f61064669cb0319c201807593c56664e6dc186455cec9e9bc53169d675fff7fbaafdd128d1d749516734cec6b261423738fb0d911e1ec19492da8ce949eb575e5c77007a11871a960fd192c19b8b7fba4f2677fd305273e1d835f44998f40a7ed61b3049ffa66dbaee62f8bf338072eadb76660c4b6396c84bcd2e502ca524003b70f8f44f8efeb9fb06ae55471d278f05baf495ad59db15e0c369be45674abb96baca9573887a3264d65c4adde57046d0759c98836a1dc1696cc90557f50536c088d48b070db902d2070ec7a99b89850dcd500f66d0fee6f857848239059b4da3954d290611f44c0564d2bc08445ef668fced856e1af89f2e3ed23bdc3c4bf6043f875b78c67b30d309e33ee3251d3a0c0148899adf1baa3042df519729ebbbe8823994f00131d8456bcf5f207405d435bfda69aefb88d848f0c6d79b2b0b313e235925d4e25a2f424a52b224ae31fc0d00e7078745e64f18608c27261fef7569349d609ccc50bca559af427a069e3f5303c18c32b10bdc0b10f8d62218741868b5f149caaab6e75bec57ef13600f8e1b02590ba805bca0b48775b296b2695f956d0088095be6ad0f3cf33cdc3d452f462739bf702e5cf6514d9fcd01f3e69203a7e4163e962ca50516a7300b72be61b52bc3ef50905bd302f86c7c0e65722913d1ef88295e8f41de0e2ae2430035592c7eed4384821a9cbefadc589bc7b4bf63652d0e9c7f1c85a926b5f31f23969cfba5d3e2d28e7eba777769619514a8fcf278fb97b77ea2aebad0f5908f3411405790e8f0575518e0370031ef5faaeb9856f59b0ccb2df715019fa8aad80e50cbca7121dc18799f3b003ab7a03f9d2f1b664da84d2c0eed25f4bbaee61ea64d1bcb2b6465380dadc0e0f8bea119b2aa4215f751117942f85f9da496c37bef83ad8e781e920ba35bca3692cbbe1e7d3b1c84545f8a4a6f62d15de7aa39581e86228486eb938aeb2ea50d2355cfd83b53c6e1f1f70339ede7ede144c5dfc1ff9cc5359ec889764e7f0218d04b81ea0251b0dab4fd5272dd366f07e0dc44a4a76f43577cc08ffa49d9c1f4d76ae18e6d23174632de488f38d90120770085d8eeb2ec95130db62e6060303a8c9f8b89be62965e823c5427e7190a7330ba49a3e3e03cedeb7fdf54fd2564cb03eb6d674318ab87e2cb937cfbef4757146e8b9c561b22b87140e84a15b56130441ac7d10168955d343246334437df990a24e9b96ffd8544e67e1cfea6f05fcc5e22a2d9c9426051e98d6021d6d8fde02b4887237f9d074d5bd5469dcd22d4fedb2aef0b403051583924c15c428e000e8d93e39de237463629d38830bd3e23aaf3eaf3ef7c39a826f07438dceaaaa426c313fffb6b2404d5604610b6e4de6af5d387c3369ba25cd593f5f0a048f40e0fcc3d9297694a276b7ca4327f9dcc98bcb1815fd7083195b4a0c13614145f7a70749228863dc98bd07a3e0a0d9311616d5e9043c4592d3b0ee5c3c0a5c1c14473ebcd063f34f952cc928f4cdfbe06e9314874db46ecd428d50ad268721b2288b6dd0a77ce29e74a60865475012fe8edb80e467286926b382bea1690cdd060c91fd8bbd664f48cd9b599479bdba9108acdd3da41e3f5b0883a92229b6bc3d998898095abf75b993f3ea2578dd33994c02102044daac54fa695c5c498c14d09d8884cd8d7a4b7b06e510008134057f4441f2a2af9d8a147d147be0cfb0e0ab7d83dcbd1aadd42a50a5db4e32231ce09375cd74e8fbb11f3ed91617f737d42210790607f31e1ef5e7ca5b54ab4eab0b726c1eab6844b752ee1a70e541dab88d747d691a15a3212842e77449e697384df89d631494a370b08997e4522773ef91eb7045c6c19eddc567f56968f6f92554e7bbec627b3ee85548b308cce15d70e0e1215fb9564420923d357b81124abc1f92b5fe1963b3e6ec686474e5eb837c4a09f793505831d125e02805aba8fe16ffa2a0559a9ce7490c8b72672f9468824b12c1925066f25ad4620417496f53fd33c9cfa61274a6b18f81ac3f1f1fd9bf6b0924e39844170b2a4a9b872b9cb6972f3c1991b7a6caacd9af275d4ec05dd34416c4de7d593bba53a29723b39279f49f0526ab6bd85fae5eab5af1b70e98ccc3f0ba4ba92cb92bbb42ac8c12ab5e3a54a966d40aac91e57dee922f69a4e479ccd88a13ac7c757c93cfbe8e1b46a7d90e5f246d9fe40681a48d3b0dbc2f5d7423e75d66e303a05d9b8c659220e0677acd76c2c801c5253898fcb20aa0159c890f8f287f87dd0a75180a1091b056319d785afe392365edcaabdbc10f6d1171c600b99202a04786e4719dc3c89fc19e77f0bc863d901c18c80d4d992c236da2d3ebb811e9c4e31dfa51efd710bcafb3a1d0e25316c18ee1b8551a3845a69cc7caeee35e7d3c8f33f3470367df94b434c84d231c42eb0bfa8ec17e5a85df9f7c6b7494197091ad41456bf2195b73c8d7b80cd05a2f8754b70ff27685cdec63072acf711821d7317424c1753722beb50309ac2829d23bd70e456e430b046763dbab5886156105490f681ed0db648cb2b7c1496c5483cb98e01876f7ea3fcf86d17afbc41ea64324847834d41d05643e298e74dd89e07508e764c9a3a3347a38d76d8136eedbaa8513dacb7ae62b9912447c5dce678f65f93b6ebccfe6413d2bafc31d8af4466ef768de2b601190231db72d8cf94826ed521c73a9bee4b3bd6afb0e8b2909359b042900d34d8f92f524236b35a289a157a2f6071a6b2aa1c927fb712b54d03997a6d0541dc23eae4f0a55058af52c082e30f9b2eb5ae72c7ea669f2dade05af4d3fe157149046801f0e5d44d9230094bd2408de6661af24d2ac347581bdb66ca6104ddac9229b0dbf05e6d5b077e4b1e3052a5b8911fb8d1c6d487665bdf1f7fb299d8cca8a92e37bd7bb77be2e7025aa57eca05966ddd5977a1c15dadf0290fd79b992ec9228752dd5176da98271f56fdbed149a1681724afd0a87027f015b039cea70589edf026adf32e03354fdcb7a723f5940a00e1db8ddee1ffe8c290e9bcb2fc818ba9c705a652bfc14143d38cb9e0f303c818e3bcd325ca18f42e2d7a8f6cf430c6d6649a31ea2db95ff9b1ce041fd781ab2b1c5433e1626f67d6c72a9d2de790cf831dec8805b0d70f7797cdb3b85130c7228fb2c53e057b118e4b488e7c29accc3c21d7ad6e7e175a242860e7ba54458fadc07c0425332db95f453ada44970435e57a7a866a6bd649c5d7efc7b07a56eca67685d53876bdc78e2e0d40d0d39d72bc73683c6037de90197bd90f19a3409bb1105f12802c7b25056f92e03f5eee527643646ac45e6742b80998f976e1865542ed357366891e6ab6e60f45ea422780de3501c963eb40c201aa0a387bba3f84cf91e3acc5455832bbe3ee8dd2cc2b8a895b062db7be10f41e89e8a7f19a55f80749c458b4a69708e9a495de52715d3d236efd104c78165fb643f5e7e1e41ae80f8031a51e772aebbe1f5791f1ffdd37847861e10174250c285aab28d1afa095ad0a17af97c4a70f9c7f6c0ea6a97795a05e70dbc376feedcce096dcdbd35e0ebe79b00a5f005f6c397efc2699c246718ac6d7fad9935939e4f608be6fa9a769cb98f757d755dd33435bc88a89946a7dc39baad5eaaaba00601b82fbc479c1f3104427966ad03c928812b0f45e25590441cc938c4bc0b610b7b1aab047638ee64640db13d4db850471511a316d0c573255102488984e7e0cc3c31abe2e86f2d4f94e2535f403b475512a499b5e205ef2e734970238a3b30138034aeaedb46edc00c1bf908bd60096886d93af0e7413cb7cb853777c71158f2da5a4a5c0989a4965c14b1ebd5a78916a9d6f93bfb44aea08bcec8bad6c981109a658e1c400eefec16b5224930e79baee351dfa49cc546f5fb049d6da023d32780bb81107e835e14bff1ab991228710a97bd6731fccfca2889cfba1192bb37652b72a043fda40dbbb4ed0c3c7415f52454478270a47fb588a7156d4e66442cb1d2bdc3d5d530ca89212e3d8542ba1e87aa9d153c99dfd3cf737258fbcefddf2bc4b7cc52c7431638c849ec553ae24c21613d85c32f807bcc5321373441d11e5a5b7a8c570bef337954fe667c43921d348f2bc0efd527b5b83a84474aacc6087369f8f53535314e7f29d611f986c938adc5758076ea91517346c0fca019a2d25bbbee23ce94927f9171e50ef7854a6eb2cd81a389f0343591258ec13958375e670453f8fad36b727dbe8a18d664dc1c30efa483fba0dbd212281be17e28e848b01e1bef664d4238969728b6e4e0837604f4ce57f250ab825432ca5337474f7fb6cfe2a6f303260d1199775ea69ee0b68976ed92af7f9a953188a1b094c54b9f27aff2e40bf6959342206561e2bd7e10b2444ace3e56e7a1ce881fc221ddce1568fc0c37af6294da283f3f58c4b751766d48cbefca3d7ac524ee95a368e9662aa8700d91bf5a98174c26f229a9879fa1100ce01a790d64cba67e8a3eaa656fd019c2a09837016561629a38560be15e4ef3ea4fc26c8cf35e85f52ac9e625c98b61010a561881ab284a5818eea07049f3680b2601b5ff21ffe6b644158ad7432222b76a420dd3ec5a1a894b3e8a21288323738e032699cba46e50c3cbc5e21061c64d1954bc0bc7b3e2750c5153ec8ac6b08b00b9cad21777c6e848cb62d18c011a888f30322539fc822ccef577e7b3918840e1da310e92491acf8bbc2ad3361c2cf7ffef18a7f6df5335d29d610d2e27b784717bcb0fd0138fae3e98899a64c2df2fc69816e7145ffca2bbcdf467d9bc3052728c8ee0caaf26c79faac9f5a21c0ecba34e63eeea7b20465398daf180980a4c74d554d2f4386e0593620b05b26fd65b5cbfd39126d2d9d65282de5ec70c3c87d32c306dbc543d9254ff74c34769a49523fec16438d29d829cc7654ea228a273139938b756716c8984fb2d405972a1f7fcfaa19f01e216a678d055fd9d026ece7f4b6e67ad6f82599077e7d6db840ce8e9a2e088a48314f2a451b3efb5a6438c9bc3ed6740c72f49f00fab4a2837c69422c826eb9d3882c62299e2e39c5c5f47dd390e073fbdf242eebb68b64562e7570e9f72a21c7e5f94ddb61292d59bddfc86d021f199eda94fb85243a399cb7cff1a55b2f221a7792ef6aa4057c92cd0386542ab026378a8bfc864dae13b4e8dca5f71bff18aedad5b009ab07cf0e311a6a099afe50bc8f988fbd049fa0eba2521d62fff7cea584dd16ca8a40726836a0c10cdfc59e3c2a0a3b5cce4deeeb990ddc3cbb755912ae985a39ab419a28cab94d81307e4bc9506e1f516c05d1832d70a9aabe252ffcfc0ad7db1fcaffa5b71b139b221382ce701d9cc1e8607a32947b47f9af317afa3a794d8780e766266a896101dd17dca379feaefb4f243a45c3886b38684058c792388df49ed9ae48b61846972481fb790eb26c8e0b915986c871672050e4cd74d06d28c93636f521d35239f46c52d682f91c317b48d93447c1855af5c1c05b1f1161f36c66d8cebba58244051d01895d09a1823e61ff6674fb3f784be4a68ca8aa9a537c3f006c764478abba3b13a4a01a931a214d8618d2130b3dcec6a622e8be8f400662cd735355360bfa81e0253b52b55f234120eda7515f7a5b304dc9535d33b85abe63e8c8485ecc63dd3f2246eb99539f7941fd469b1142bfd7e196671fa5fa51080749cb32df0e2a04c47e536991e7fff11fdd7fbfc90333a56284a3f75a488093b831e021e3600ae32958d1dcd6ded8de9b489a3e7906cffd9eda6bf3a5194de80e7cc1151f097ec445c8f51e3b116514982d35a7fed32a19e8e9ccd679f1ffbc16b39be548e1b1ad158de15669d34c500d28769f3a488ad16a9030fc13456e75e5c35067a92a203e68153db6610c942a6c9bef07f529cf7f100ab5c16db647dd71d07b467e425fb157db8448dc4111084344904a78e516a022aded0ddaf45f581800036952fd22ae229d6c506cec8630438beaa39a5dfec42927d6d488e056ca06e02e6f18001a80b57e195f0da2a470b793b75e0fbe9101d8ba54a38c5a86d6b7547ab8ead80f47f40d39ec6b03b3c280854a825fc43d32bb35cdf2a80e5206ace26bfbf7b3e4112e22d47c1eb92c2632bef285fd8e43d4d4cbfb3506deab25985cd7661fcd177faefcb025a10f6c0537bd0c25c902d3b6ac2e7450868b9396cc79beec7436b201279f748b5fa217d97e435be6b456b2edcf99e85ad19a3b9edb344544d4619524906beb3dfb7c0de8bdde86b4690f62c15638f31700878a18136c");

    final private TLSText sentEncryptedText = new TLSText(
            ContentType.APPLICATION_DATA,
            ProtocolVersion.TLCP11,
            sentEncryptedFragment);

    final private TLSText sentPlainText = new TLSText(
            ContentType.APPLICATION_DATA,
            ProtocolVersion.TLCP11,
            sentFragment);

    @Test
    public void should_encrypt_TLSText() throws IOException {

        TLSCrypto tlsCrypto = new BcTLSCrypto();

        TLSBlockCipher tlsBlockCipher = tlsCrypto.createTLSBlockCipher(parameters);

        TLSText encryptedText = tlsBlockCipher.encryptTLSText(1L, sentPlainText);


        assertThat(sentEncryptedText.contentType, is(encryptedText.contentType));
        assertThat(sentEncryptedText.fragment, is(encryptedText.fragment));
        assertThat(sentEncryptedText.version, is(encryptedText.version));
    }

    @Test
    public void should_decrypt_TLSText() throws IOException {

        TLSCrypto tlsCrypto = new BcTLSCrypto();
        TLSBlockCipher tlsBlockCipher = tlsCrypto.createTLSBlockCipher(parameters);

        TLSText _plainText = tlsBlockCipher.decryptTLSText(1L, acceptedEncryptedText);

        assertThat(acceptedPlainText.contentType, is(_plainText.contentType));
        assertThat(acceptedPlainText.fragment, is(_plainText.fragment));
        assertThat(acceptedPlainText.version, is(_plainText.version));
    }


}
