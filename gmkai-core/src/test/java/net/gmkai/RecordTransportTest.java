package net.gmkai;

import net.gmkai.crypto.BulkCipherAlg;
import net.gmkai.crypto.MacAlg;
import net.gmkai.crypto.TLSCrypto;
import net.gmkai.crypto.TLSCryptoParameters;
import net.gmkai.crypto.impl.bc.BcTLSCrypto;
import net.gmkai.util.Bytes;
import net.gmkai.util.Hexs;
import org.junit.jupiter.api.Test;

import java.io.ByteArrayInputStream;
import java.io.ByteArrayOutputStream;
import java.io.IOException;
import java.nio.charset.StandardCharsets;

import static org.hamcrest.MatcherAssert.assertThat;
import static org.hamcrest.Matchers.is;

public class RecordTransportTest {

    private static final TLSCrypto tlsCrypto = new BcTLSCrypto();

    private static final byte[] handshakeData = Hexs.decode("0100002b0101e268eeffe79d21362ef82c7db4fc01d6d13766832be1f9210f45f56c992015ee000004e013e0110100");

    private static final byte[] handshakeRecord = Hexs.decode("160101002f0100002b0101e268eeffe79d21362ef82c7db4fc01d6d13766832be1f9210f45f56c992015ee000004e013e0110100");

    private static final byte[] sentFinishData = Hexs.decode("1400000c6532dca5ea8aadc0351f2776");

    private static final byte[] sentFinishRecord = Hexs.decode("1601010050f2f24566cce2405f12c507501526a560f6dd4d38dabb384dfa01a99f80c60b94aceaeded97ccae45273a51e4e434a4fbb54b6b2b284d309962169f62caa0d044070e72b00aa9944531fbfb86aa198f17");

    private static final byte[] revFinishData = Hexs.decode("1400000c636f5868a833c86cc18ff3c0");

    private static final byte[] revFinishRecord = Hexs.decode("16010100501ea63b13612f266e533748fda1c425b80e68397f0aa85cba821ce84314b6d140ba76cef683ad6472377a07740033113a0d1cda6145cd3b41bc71b4bf88bdaa05ebc08a76d0ed5b51ba61da52654c38e3");
//    byte[] AlertData = ;
//
//    byte[] AlertRecordData = ;
//
//    byte[] ApplicaitonData = ;
//
//    byte[] ApplicationRecordData = ;


    private static final TLSCryptoParameters parameters = TLSCryptoParameters.TLSCryptoParametersBuilder.aTLSCryptoParameters()
            .withSelfCryptoKey(Hexs.decode("533aaf2ef3292c54c85ed5cb8ae0d249"))
            .withSelfCryptoKeyIv(Hexs.decode("50d2cf238c7810793342a5013dc82f9a"))
            .withSelfMacKey(Hexs.decode("3e9f03413b91a8adf6519365490079a000d2dd4a052005853adf7fe7041ce13d"))
            .withPeerCryptoKey(Hexs.decode("8c06a8e3e890f677703956904453b386"))
            .withPeerCryptoIv(Hexs.decode("871d2a1206d7a3e6e83fb238f5c95552"))
            .withPeerMackey(Hexs.decode("3be723bff1b758ec8335ea3ff988f43c5a9f194ca12560f9a52e6010f370fb57"))
            .withBulkCipherAlg(BulkCipherAlg.SM4_CBC)
            .withMacAlg(MacAlg.M_SM3)
            .build();

    private static final byte[] sentApplicationData = ("GET / HTTP/1.1\r\n" +
            "User-Agent: Java/1.8.0_221\r\n" +
            "Host: ebssec.boc.cn\r\n" +
            "Accept: text/html, image/gif, image/jpeg, *; q=.2, */*; q=.2\r\n" +
            "Connection: keep-alive\r\n" +
            "\r\n" +
            "\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0")
            .getBytes();


    private static final byte[] sentApplicationRecord = Hexs.decode("1701012040f2f24566cce2405f12c507501526a560166380f46540948f77561a79f1feb9b1c7d393a53be588d3953504ec68d7c67ae9be645dcfe0dec0bdf71e39a768ba5faaac1e089d00e87d625d225e64fc050013af1ca12ef85468222384d44ec4aca050064491e548d45f00fa9198e70232862ee291adcff21cc50599af7d588040897afaa6bd4e176c504b57c8d1294b0eef64f3777d01fe2a3737432ef3cb92307f3aaae8805932d0608792050c2ad9fbb8b1a61e4334b7bb26ab07346f047c9e3a608f5e320b067947790eb421fd2e7c438a5f7be41a6223e3dbf1443dcd2acb573421b871f13b629aee8cbc40471eea8bc2e427ae01f7a4f29f26eef5151b38a00497682179c99677701104266355609bcf2259b98ed5996ff060b62334d4b79e2f2c887a5a26b37133208bd00b812453af4094ceea3c0c941e29ad7d10cc6d36b4d49e477f7a89b2cb1ed1e9a68ab0ed53553c15b362d8f2e4448e2b046d18c0140915491b5e13f1104ad33592a0c083c986604c30be3b675da3a47d4dd0a23f08a0cd6c59ccb6a4bba2ca5cdb50b2861e9e39d124a40d9c6e0eface48e30d2cb2a1b9c1ff31721db1a3df7fa3312846aea212f1bcb78d92c181668353fcd2dfec117cc6d198910f00eaf7038461f1a88d3ed57b620dd8edc39dffb5025a1de73d281862c21e709ad449a3d5572610d3d48b1d4d6aed3533f6d85f9d353047f9476d25c7aae1ef036c175eff7108a1adce588290cf7399438a3681b1f6410c05d83c4041da413c90d0bc68c468ec22b4ecdce9797b26b6d93762f5c597253f6ebe8a0ef45e79974b87faf0605524edf1cfc4caa8bb6f332019492b693897b7268049075b0121eaa7ee36bec4b82fefb6f0f77423df1e1985db7840a51e0a443bcb9a60efd3d36b2c87185f0a3ff2ca12094ef55cabaa9e6f4f780eeea588c9c818e943d2c692130ff65ad468963198eacc4f91054423a9fdf0090fd13155d983b3126fbb6efd5f4bc8fd6962c4eedb1af897c4958dfb5ee3c862fb91ca439225fbe6418217cc4137792afd25b5b5e9d532c5f428bbc315eda922d0a6ceff4ed79ae4c0da152ea8bd7c07de1829c939b44ba2033014f03a2695b17dd15aa17298a59a9c944d623de91064d5cad2bf969023b4f9661fcedf8ee4420c0c4835ede8071e58dfb6b98b69a5d897edc7150de1b4a9c0976723e2277a4d00fcd8744bf93ef3206389921ac78375f1d0ffac5d71d9dbadd80ae8465b3c3e1e4e3182614c21f2fcb9db075f207600bb384a8a70f9f5a337260c9b91f80b39af8adfb3f4d5689fbf5766ae3a8b7e82ac77ece6b944130bfc0ac838c8162557e51d4539d04b82710b2f29137aabec233b23987c519dfacc3ce1c1d312e7b634bbcd85dd4574bdd16f211be168aa1bd145c7867dca5922f68761453a7796323f2183278ccc663d684eb9134038aeb7badf59f224d1788c78c20ca351b0c4c1744d3a81269170ca1cde5c4ce9f859ff4f3a6afac9537f6b20d69e86b6577d35c97d7d4225a60339ea7f5d6e4ad00616e80009b074d914398afd45f7c5e0620958a31032d4b197b1bee8f91ef8c31ee9a82052fcc2f662772e3c7e4fbc977243e93a2ac138cdf6ee27b4e8c2a3ecfbb1ed7b7b4251c821354bc8c38740f8d41d193287fb3661afe53557e1599a6d1101faebe3ffcb0a04279b95ae59c1d6a1beb06f083df5be19afcac8c88e363cf9a792a9181e50250d17338f9f8f0d841295bc339183389281935294d8d898c0cd395ccfc78754b81c667fc8ccb960e1a0665927bb0e6a198acfa4256d5cef0c57cd21544e22faa17d78b96e3a683a1543a902bd29f60477d8f70028c96331485d64d36618ee10593af29fc6997510682cfbfc3c6056b20e587ba13d6435f5d0a267e337735394a9c573230513fd9f336f9d57c5f151d978e5c25ddce80278d8e46d8e6dfe6689ba13943fadc18a151e07885c7c0fd0404487ff5defb0d5a1a4757669f839c04ab4a60dc14e845065f36fd645699df799a2026f6d0aab7e6261d9c00291185b37e55d1fa5df7e8b76453b6f07edfdfd679028f4fc59c2458618c250bed62a4f9a04a9766cd47a8aa8756972a4fe4845804c74dbb77134955fc28ee8649585225d8ee492350f74396b22b5868f6db4829bee27416c02bbeaf4968853ab1e4159f38ec35a536e645b984d8597805857bfbb43393082222e5f222d75a278ff107edb6a3c3d90803c6a474741a804247fcb013e703988ef99eefacf294d27877a523e7708195138e307fa434df06f449f18022a9541dfa44fe73db7151bc204c0502c8cc0de33e4177678cd195d2bc0b3dd6d803f690af661aa162bfcf06b88d22e863b70dd920e6fecfa3cefa621eb4a10cd745a0b0237a9b407b8866b6eecaf6a0f93b2b746930c0df136f8e201f9f457a5ec0649048f5551cf889b7456afb83113d29a0bf66aaf27e9eb87e59e71a2ae8f2bf15745f88f8a07247bf396709509fb14081e268796504af631dd93869090d1da74bfe305f99a47c8ff6926c6b702c41a3a3a32094691341981f1c4c61237ccf4b992e1f9e8bc642299299f437bc04f9e8e8b6e974b56d119491d1f42312ce4b090d7a5d8721c24389e98b9202242a614afafc62c0f9789af3a30d93f3d7a53e720c2d817c20ee9ab19835a2b7c11bd55c69c0c2e69e618fd2c7c057eb9a0556590ef8977e53c384223712bafb746fe470f593f84fe39f30d32032c7fe31564919147190205a89feae7354c3910007951759d77a5da7f92cb6eb2825de885485f6b7c027abbd2d75d58876ff60a1c60e173bb86da4b5697cf2772c222043b9461502438e549b00139e955160bbc1e752d5835187045dcb31272395d5d059d6c13a87fde70019c6ac32b835d6738f8a4bf903b65714f1f2c5db9e241e458b61afb37c7b11529d87f1202068053386cf374c62682cb9b24d824faa7e54823774131440a1ade4678605d1ee92b72bc1572b271feb740af3b4c09ce9bc15f6a3bef8003988ef251351467ef7bb02a7c218456fee0bd5aefafe82176ea35e39efb9ef50d72b5fdb5db14b55326b589e0803d38d0e3c0f0164a4ed0765e1761802bee37f14523f8a4cba3b612383928bf96f78217ae26f262e891a64bf7cb64e084a42ba2f92cbcac5b28bed88ca338193f034d35db055fa2b0f7b6b8c837952e3e20fd2e62459c0d5a2d7c4b77ad3579108eafaeb523295c7cc79ee2ee67c0f34d154cc357e701d1233ea6158e3fd992e72d63fcea3f58331dc073504d5d688b376bc7830fefdd48ef0354c7e2a665718c9ea505ac7bcf27eedc805a2eaa520fdfee19de2bda7b0910e982cbbfd538a177c688c76e7a1ff55b231e337a66588f07798ae2322c2fd2c53be9b8d90e750a0d80b274094d3a055a269146ae3ff5ef1f3cd0829b6bda4127123b6bbfe40009b7e8863f5428cadb174e9e9de80ab4bc0ce036920b54a6588e854e5a3769c55eff8aebdb53f133b3c667293333d02eeac25c91b4da8e5f29f6e17d62bc0517dc4f397a5fc4cbc4d91cbf60d058f1f41388b4b5f5ff839de0c8ff325182776d6eee2aca9befabec9969c7d7dedd8dc935173b4ac2d29acac7be26b3d7c2b6f7f402a4a98773b5158c18efd3aad5e2a6016b20b8c3f1fbb2018ec139f18271485643c22bc91a1c93032ddb40cf9c6fbf7d582cbf0acd388456faaa8608762019cfab979b267091796a71459a8baa55fa81ddda944d347d155952a5b325f8cabafb53478923b443855daf3b99e75843d4ffecb7c337da6e664747ce50d4d81029ea3129b1a3e70050e766ae181ddaacffc06bed0568a6ed8772757bada4af4830724bf7c2e95b2887862d18e3439b6536fd6f933bfde3621f75a320341c3e0c7cf3c94f4252dccdeebba57aa84a7a61fc8f7d0e31e82ee23f413638726a1a6f343250052fcd5fbb67537e46219476bfd685988a438c24f07d533cfb7a22bbcfb1e6d0f37699c12613266b8447575adbe2c1923f10dede2274eb7d1a390a4bb18c46754c53a91b441a06567a531246cefbee1bc671e28e6786c142e3a91789e75ffd639a137276fb93a1816bb9fd3fc42829a5ca7d48bc8d7e1cb2e065ee70415a4cbf683b8fc53d6af0db5abc025efaae5013f3743e06b29606c370602727326d0efb44d3aba26166e6c9c990c76caae13adc2d82cfe5e1268e1ea1629494f83cbf155b493236ed420fe5ac8dc308b0f3cc38c1bf8e1c69f24de6bb7dbae02888f6c76569cae3723cc3346706428a0aa0c34e587177c233948166979295508222a686f23a710c5364e89e74f5494669f462e9475433b6265d134ebacdc7cb1071a37cc9adb90c015c2cc19fd893d237eff74b5ec4a26568941680475f5f14f50cbfb21098dadc90cc4a2c300b741e13ffa0980d68f4571f96b20684878e66d34b0c3ff99c82652c5ead80c474b8582fd15ce3cef80001d433f87a6b6811759d5e0fceb2f5709b38d6a48068a3938cfdc5fc65545418e3b4ef7bb3c3a0a6151702a0634396994a9ecb857397bd625fb1223c4680b6f7c716345767a629b3bd52ba319c16068efd7e1776bf6f9f4c4d11f3ad24a616bb130e46ea48aeac374aebfce03aeff3edf09912c7d68bd425699ec4fa883a13756b30af3cdb42ef9785e499e35c97916404f364e31f656ba05b0d2c8b8ca9f89c4425df3132dc6dcd8a6466b6b08d331fd4faf9383ef00aef0d9a5635bf0a204668362cce90bc25f7af71d2914f16c58a67e7228d0eebe7b104885f50312bf41eebb6dcd589144e7f2afbdf1cac01a6f2eb87f27b64b071e34c470b95b9d386101323ca531b0d5f1402b78fce90ad94dbb47e15d2b97742cc88ca9b8bfd9e5b78f4c8376a48301d7059de0ec9c328ae40d8d88bd1af459d6bde35a1b1f7fe295e7b151f3ae23de403e9c367feebd752ff1cdcea05ef21abd45560b8180a2c3631b83671d8b79a971e4c1f8f035dad10355c9ea34441579f77c5cbb72701e5976c2ca66b2576d80383f409345f6e4bc232ee5aacd14f39b69dc49a90ffbec8e52e8e53db329c4bf4493c2d255a2dc007199c4a34b9ef67bafa71271061bfbe89653f6434c5631624414d6591cc303265fb34954792b0e926d43675489277e65a3b65743efe407fdc0a00a2c8240e3f53231d12dd2607ddeca1061f6754ce825ab4e0f5c1d5931041f1de7e2260425704dff493f05cacd888719cf6863a60dc57b7578e1a42765f6973198dc68598abb3b640e1d2cdfc84c16d4a8aedf3c74fb9b58cb994f56bbf9d63f4fbeba1bc94a373ab0803610b4b2d5febbc5c480495f2f691a36bf865be077d750195a49882968b7cbf862ff77bf9a77c73d11d8f547a18a93c517b2be1b7fc92f4078f2b1c9fda7e1d120c50b50acb035fa94b8e4c9a924d7df10f27bffd8ed8c2ef511a393558cacd1575f40be9b2b421ff7fc822884d9215467b42c5ac6504744aad46d2732e99d1bd4e67e5d16311162eb30748a4fb8da70d85c51b4dc263c38f9af8e40235c63227125478df9094f43672076f07e8b343b5ff0d6e2bd0a8fbe37764af6601ce19914f55a61e7ef87c251c603fffc2484cc20a68dc9484dad26bfc8e0fb869703ce2f5283f68aa6db56df016f1e80296c393a1b3d5267d6c5efd5f0b980cb476abd4571c8d10217522f669c92125dec0364914f5e965413e9149ce9350125758c2d60d5d18b8a7221a68c1f68bf66e36be84979d9656b8ade559d450ec64c8689744c37cbf9fadc2045bcac30e4b0b5b3fca69775849bc30d4e95090d8ce8efccd991c396ec9b005d3f6f614863b02cacaa0e2ce81266354308e7028dfd9269051037fd34988de74bd7ef578901e20f6c9fb25cfa740dedf54d90288b2f9fa169108604a4dacb1456fc6533335269828000c7340fa6fe051721d66b6d9dec2e8275cd95b0f723f476fc9929a968a164b1e60852817c51e844117f9a076003dbe2c22ba853bd36fb5e2f9a94f2444c572e423a9c175b60df7425bb6a1abdc3f0c590e330035398cef32ec60300a5d1e0de64c568e1dbf5bb004ecc1b72d97f9227da2aab12ec7172bf4082054fe19e1092ec0d5f9b91be4f1d3965ff68406dccdd6da6f5342616963a12b1e750cbd402e727886bf3e03af9eb44fd2d730775638fe7f9ba1dee89c8f7614b476383d65c66b44e984a3de666d8ede34ee2ed658ac0dc2095db93eccf590c72e1bf8ba0787df9daf865de2ec3cdf986a486b37cb44c826f78fae32613e04e9f01086b8986218f87098db17c0545195ef88213a0aaf56de5890538a8dc19cb5bd7ee7d061a6a970ba784c8604b64ecb5416bac59ccca17ce0062f056eb3d28c00e8d2db487820c15c5abd78fe835e306df43efec95f8afb490dd607c3321eb12d3582f8083fad6096a9b4db8224c44d2127e2d24b3f5898e2b4170305b493b4cbe943e4deca2c4c3fbaf4d7f630974159a36a8ce2e40caeaa12f69a2715da9122ac1e01065ff9ed289eefef9f276fe8ec443b34a22ce8fe7b0d05deb0cb0460852ce2a2e3dc65a184527fb725703c5158f93dfa0a059f0eea17f77bb5b9e9489d3197946119cd3e89bdf2e0c38287e09b68a07d4cd07fa89faab470657fec6dd40308c86e098674127887e1d47f8917f976993f758719b533cbea11bfd2f7a8fa7a0647cfdc4a52a2edc97488d1e0f940f2537859057f6d577e44e0bc9b816d0a287121188f41fc6386409db7dd969da61882abd2d57a9c1b445dd224e74cf0b957fd6653b83be9798004ae1f950b11e577ce5a898b634d03f576806ae9cbe9e5e2b17a002023759d9836e6a9200c141d203895241e156a959d63448106596aa8c2ce680b3735f528f4880106e0f9e0cdcdd6137fdd28af602bc73952150db4f2a59078222db2d81cd9ae8fa88b723028ce0686b7c621a7f4847fd7d4993057fd8a9129fc5626e1f41df9e48d7787af81134f8e160b0fac04d3d1b2c3a4648163c1200691ebecf1000c4386420a4c215db54e140b7992beab6551441c50fab78cad911a480907840b80afcceee2fc8703c61a517b70462bc27084fd345952ae5976c35997c9af36eb253c30b19a30db2e8da7e9c7eb46d45a494f9aa2d6fde08ff3df20183939a4156b36d37a933a7800b7ed6d7e35040a105371dc3afee771526ddaf0d0e5fee22469f0fc8047309568996b90abb16fdfd65dc35039993b8aa9c44c87830920cf232d722791bea59044371f7cb897b3a1360f1605da8147ae8a16527ba50a847de23dedec9280d572eabba0f0ff604be9782c83a82ceb7d47995dc3243ebbe35841889dbe6e9c6025af0c9e20d3c9f79aa54e88db40754667c5f38284bb80d8cb45bb8bcc394112cfbe97d2b93e4f5b41b438624aa6549072e8f0f1a73e2bf163b063aef78af6aebec66e1136dc42eb49bb644e3b3e7c6fc1b20e4f4f04d0b2db6582d021a83b2d8c607959af7d6245cbb8027b142d6adba70793d7be0bc0ca853ff4a039da51bf128750b66780e30b9b03f28c1c57a5b85df8027b40c45cdb98b18c1975f324caaecbd73703db79f455f60b002afe1a8fe2ad999fe08de13e6d70fe29e4ec65e51a75add4375606ae8767749de717016597ab4a2f8babc98f3cd29482acc1ceb578e34c7ed81594140f1021af502cc23a40e52b4bbe867c0aa66c747191d927a9bdfa728df226153c5a445df52f2b192c3f21f9d5eb73c7c0a920ebf407a3b46dd5e4ac40867b920585b4801076ce10fb7de15145868753df40c7bc84510735f486f2206ad8d98759cb8c9538b4eb843de31774fb12ddde5e45d57a3eaf5bf7e3c83e2bbba3e79ee8455d469e8a02ca4415682573eb704e1d2084d525ad6ef9ca2c955804972eefeceb772883ac677463081da2b1f4b59ee5b3b63075f603b65236b0c15f3a2bc55bbe538ec273770e98ced1ab773b9e7ba0d5101b91028412d320b0b34fe3d1c464fbac581b47f437e0ff7c2a4b310bc89fb4ea9b0c064a86ef7b5e6e03e87de33adc28558521a31924c9b7159ff83d7716886be4f7d2bd4dadef4993c712a585d2dfaf2f80f48a8e353ebddd76b6c524bdfed1c170501dd2287742c5ff67bf3c6c6a94b0ab62d7dbb5d69e4f399566177109b86f788f273981014daa63c1a5139ad20844749b2afc6ff123adb362704e86111256388ecafae9cf315e8d3100a9b472a708585b9631067e8afbffed6f7a093582b20133acb52c16cb5a791f1cffcc982b37b3a2a4db3a600c28bdd30205c2c3fd1d3dc1bef66eb9e0145b6dbdca2e4a4a8db42caf86a89c3c4de2365d5e80a5fd73f26c5933551eacf10e90af6829bf9dec17fbefe59b575e214427ea6db51ebcd1ea50fe6bc2d8434c2a9fb3fab29e4dd3bfdadb47095893e5699821cf2ef0e8a40382bf3335a84f4b1208045957eab9b39017364d3b4d3685565f1adef7aea3b64fc379c97d9c0482ea9cb4fe36190c20cd85e4e184e038e7881212f8049bda28effaf656412c8b8796d678d29adad7a5a4aef3a43c879b4aac553230981d08988f3428753073fc032e37cd5ef3331a9b776cc2d54cbfeea088051158e53779b3366b42efa037aee8658e4a286e850310dd1f149a4b2b0357d69614614ddcc2ef155a12b26853035368ef80b93a50f9e49ff57f105b7b5f36e0a4bf5037d4681d47363e9a6b47e9cbfbe4cc2556a2e89448c8afa5f2dcd0ce3644aa3953fda81d614047f27e96411d8dbd7f3e6413a5e045d1c2d0a987008ed5320da08f28d0926733764945dd1c52b4febdba5ee01ca6004080e39d5533bac054711f9b0c716f64c3473e5557c29fa48be5d31515f40e07d53abf44c7c5785d578f13033d8c921afbe6496720157f5281d3a785a7d30308da7e18f6aff9b921812ca4a20cfa9ba9f31e0207b8da728f65ef25afafa9de35e6147c39056d3898543e967a3dc2422e8ff93857b0bf6836b715451fbcae0bb3890090a580ea5eefe2b3a774ae91aeb0ec22aee0d14661f401ebeb987d5166621d3905e10e0086eedbe2437f9b1b886f726e6cf6801adc38966996e184b00409d571cae58d728e05352f7a8ed8ce523207720591bd6216d74f4c7dcea8f2a9b50f97004e04cfca49c5208ffbf07bcd1f24a8244e6154b43a6ce9c070574a99568e7dd804adc2ca4f1afb6e048ef03e2b755179cbf388004de99e2a00f143f19caeac28dd03acceb9fcf061ec4d7e7499b54deb1ef09eea74fd82fc8f5d5f71c34b9ee26c4537b7f4be30b2a70c16aa1c5c4c8d07f8cd4c2a978d38b87d049049695701bd8636ec8c4e76b09d8dda311794a522b0377607abd2a92df0960265e88d49cdb2f4d6e4922779314211132f4641ec0a1b657e98d26de605eec53cd53057970af759c8d00efff86870bb43108150938eb06602cf9f50fd45bf3ddeed6a1ee5b34dab754d53265d78e6616ab1ad662da57b05c515e4a212cc9c30bbeb346387dc5365f9496c3af50e5a7f8e848a8d2684edf8fae7065fa40f61aff76b66f963a2c0746005a675720549d639b3406ddb3b2fcb7c93a59de4df8e7d6e2bf3148ec1569232d7ebee89db7487d356c9b1df2e6b5460ffd34a1c97a3d17747a86f69ac159e550c263c57af4a1f79f5e38d2e778e3949e169d96791ff4ba6d65bded3b606814b6ede677082956c26ec0627fbb7c41e08296c20a4c2a885bef228e8a1e1d14b166e0da96fe64317a6a11e361f15c264c8c080e52a5ff782415d21cfbabd32ba24068645f3050935f720715db0b5be1d5000b3840ad4ece02b52bc43d2f3b6e7015aee5cbd6767816ea006d0402ffc3df86d1c52d13669ee5f00a465dcf5daac954b4562d31699ea5d914f25fce8fd5e28a3f511b7f70e438ea887d31f3b59f22c1fc6d2bbd15a3edf1c5f1159f391a997da24e8b753746451e83dccf368e059c1e3904b4058f19630b2937247f46521edea9113604cd9810dc9aac342e139c91c4e70e2083c789fbcdd8fc53fbda4e8c9c4946301f8fef88ecf8daefd801f3bcb7cc5d3808a6772290b25f30f2b7c94588403b89834bf199bf129231ace8d4ed60b6c841f9b0c1942e0578c88a2ea36ca9a357355795d39e28df8ad3e75372ae650619b5f99bb51ac145e11c5d132097d47616693263f884eacfb79cf87da5e6a3d14ef351beef09de385d7368fdcad1c45bffe4f1adfafb6ce19376f6c379a7f83c251c668f90c0e6d34e3c50182130e8145abb4f9a2104dc0668ce45efb2a8d878cde3d4a1f8dc53e95df0d53233c64b57d608e6d3020ef9d41fb70a26d61ac08ff076da3a76de882af6a548e205fb58fc667df7c1c9e3b719ee713d918234e3fbc36f0c01897257a4747942f715851bcf1b9d2b4bd7fba7adb82f7d7925d06710ec1d6f9d18c3c7cc507be094f3ee16e8ed32acfcc727d00838da268682c46c8da27a8c3025416624c05ce6d0818f76ecaecf914ec731065cc2a39a7989824829ae304437cf27a78960ae35ebdb915177b4fd6e23ab43444af350ef847e9d0be5bcdf4d2d4cadf2faec6d3a94136495a9eeb695118fbbb9105bb4d31164d97064d9661a3b73521514defce3c960441e92ad44924ac02a5a6eee0b29d1d02e3670afd252f90f4bf6f4c4c6e05da4a347f5015696a6f9974b7c132ebc120e1b61854f750983965e7d6e8f42242fe4d40d9004fa830bc04839cd726ee6b819b3fcda69708eba09c524c8e6a20c414257a72e6607c64b32385ebce9ea69f2180708056b305b1f0598df9de5c2cd613c0c41ce67f6f868b1d483f8a72ba0a59dfee30c5542b9512e1395a55e0ab2f4661cc4d34a76385700400019b395d5c3548ae4d9d7a896b5c2f6816e1811de200147886a8c02b9e1d69dfdebba906c9430cf86a90165df42e82beaf431eb5bb2509f3aea0a5f5b0e92306cb67e07423c3289675282f518c0b90afc3e81658dedb31392dd7101ec8c56ea636ff50e3683d967e123064b46dc179be87c43725dc1f646f796aed644a9073d5b0d7850d8d505735ef5a2af9daa3d21e19f9efe338265097f9a455382669071a936b1a5f6eb0683ac8b399802a34b72abbe0d303c6273df334ab717b92531696794c0155903c6e6911a704627ee773b7987069a975ceb1905bf8390e49ed0300eebecd209a415ebc0126b6356396cc7fb49c38c5fca4f7a257ecfc4c1a7e0648efc41ce0ffff12b74adc4627aafeb63f0d886d13ca30f80cfb04cdc862147dccaa37e819f4cf282ddd283df298fbd1ca6c01373efee91cf57c597c7a0e7663114bb491c28c5ea5a9799993fa590b5f1038d2806820280f74c03b390761eac45238d0c23b3e86f65b25769c303b18138f2fca5d1c9b202a39bf83a19e8ebfb3052ce0e8fb944f9281764c22f9613542a133b5f8639e1c11198966a28aface35491ba291940b8782cd68ac14c25bed51069d1ebf618f1b6a5aa2c0808d18f9fc9f05b1bd5567c20ebff9dc9167a31063c382fd833c781f44ad107d0571586f83e59df24aeb9ded102590a579e8b6ea8b12dbfdfd6d69c83f511d218285128dbaab8cd68ddce89a7e8f36f4c9f223a46404f3cc5802bed74fb594d6c670a1d6072feba1b5ba1876ae6c980bab831760edfdf6f4eafbfbd1f3bb8b44a843cf04dd2d1cba00660cbfe5982a61149b");

    private static final byte[] revApplicationData = ("HTTP/1.1 200 OK\r\n" +
            "Date: Mon, 05 Sep 2022 01:26:23 GMT\r\n" +
            "Last-Modified: Sat, 27 Jun 2015 16:48:38 GMT\r\n" +
            "Accept-Ranges: bytes\r\n" +
            "Content-Length: 156\r\n" +
            "Cache-Control: max-age=300\r\n" +
            "Expires: Mon, 05 Sep 2022 01:31:23 GMT\r\n" +
            "Vary: Accept-Encoding,User-Agent\r\n" +
            "Keep-Alive: timeout=10, max=100\r\n" +
            "Connection: Keep-Alive\r\n" +
            "Content-Type: text/html\r\n" +
            "\r\n" +
            "<!DOCTYPE html><html><head><meta http-equiv=\"refresh\" content=\"0;url=/boc15/login.html\"><meta name=\"renderer\" content=\"ie-stand\"></head><body></body></html>")
            .getBytes(StandardCharsets.UTF_8);

    private static final byte[] revApplicationRecord = Hexs.decode("1701010220e9cb33bfb5d6f1e3e8c6f423397ef4e83d50d0e4fe821568f6344c3c9f80c086b5869c77c79528ebbdbd5414a9e8b80e54e6092037c4328fdbfd59f7a437ce1ad34db234b618a9a75de7de60cd96bf5e9919bba723109e7a8cdf9724b3184ae15090d11b8dfe9adccf6dfd99859f90b5feb667d0a8464e3c8ae8b9ab0d169c6ec0bbe771a3db884889f3cf0ca507f7b2a73a69105b0efbc5128a7fb0b1d3b44b48dcedc0f0657900e68bf5534b6c4bc1f404da4172f89a906e7d07bd3628f9c51513434039a3d83414cf0ccb61e253fb63a71c6c39c0c950f6caa9dea7af46a173d6222aaaa910c83f5e0194bf929f56f85afd042860e12711b46b76b3980ff8c052e93fe1af78fb7e5a2a9895ec165d41a45e16313048f81588e1e69f383a33d5c883693b123389d4e23ae92654935a2afb2f2e1ffcdfb1ac178054a8ebf177526088d2c0a729ff6059f43537529595a24d8a30e6c2b7123f8c47b82a838f99f5a62cd532fa927a5672689595833f4861b813b72f7dfdb2d9797cc4c411950e3ef6f746fe03a08598813cc823dba0fd89e3e86b8ad3829ba2a4c162a0b749102f045118ec33c57fd4ced50b9b00eb29dfd2136e5bce248393646d412ffc4f305a3bd9bba119a8680ca034a77485d6efbd952c318dd96218a280c9f4ca78de1df8a9c52539100c514f61be75500836c930aab5e355b8837ba70f364e23002752a11555c293d272650c5e2c8eb6509983f6e87537e0a466419eef8f62dd32fc4b");


    @Test
    public void should_read_handshake_msg() throws IOException {

        ByteArrayInputStream inputStream = new ByteArrayInputStream(handshakeRecord);
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);

        HandshakeMsg handshakeMsg = recordTransport.readHandshakeMsg();

        assertThat(handshakeMsg.getMsg(), is(handshakeData));
    }

    @Test
    public void should_read_handshake_msg_after_update_cipher() throws IOException {
        ByteArrayInputStream inputStream = new ByteArrayInputStream(revFinishRecord);
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);
        recordTransport.updateCryptoParameters(parameters);
        recordTransport.updateReadCipher();

        HandshakeMsg handshakeMsg = recordTransport.readHandshakeMsg();

        assertThat(handshakeMsg.getMsg(), is(revFinishData));

    }

    @Test
    public void should_write_handshake_msg() throws IOException {

        ByteArrayInputStream inputStream = new ByteArrayInputStream(new byte[0]);
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);

        recordTransport.writeHandshakeMsg(HandshakeMsg.getInstance(handshakeData));

        assertThat(outputStream.toByteArray(), is(handshakeRecord));
    }

    @Test
    public void should_write_handshake_msg_after_update_cipher() throws IOException {

        ByteArrayInputStream inputStream = new ByteArrayInputStream(new byte[0]);
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);
        recordTransport.updateCryptoParameters(parameters);
        recordTransport.updateWriteCipher();

        recordTransport.writeHandshakeMsg(HandshakeMsg.getInstance(sentFinishData));
        assertThat(outputStream.toByteArray(), is(sentFinishRecord));

    }

    @Test
    public void should_write_application_msg_after_update_cipher() throws IOException {

        ByteArrayInputStream inputStream = new ByteArrayInputStream(new byte[0]);
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);
        recordTransport.updateCryptoParameters(parameters);
        recordTransport.updateWriteCipher();
        recordTransport.writeHandshakeMsg(HandshakeMsg.getInstance(sentFinishData));
        assertThat(outputStream.toByteArray(), is(sentFinishRecord));
        outputStream.reset();

        recordTransport.writeApplicationMsg(sentApplicationData);
        assertThat(outputStream.toByteArray(), is(sentApplicationRecord));

    }

    @Test
    public void should_read_application_msg_after_update_cipher() throws IOException {

        ByteArrayInputStream inputStream =
                new ByteArrayInputStream(Bytes.concat(revFinishRecord, revApplicationRecord));
        ByteArrayOutputStream outputStream = new ByteArrayOutputStream();
        RecordTransport recordTransport = new RecordTransport(tlsCrypto, inputStream, outputStream);
        recordTransport.updateCryptoParameters(parameters);
        recordTransport.updateReadCipher();

        recordTransport.readHandshakeMsg();
        TLSText tlsText = recordTransport.readApplicationMsg();

        assertThat(tlsText.contentType, is(ContentType.APPLICATION_DATA));
        assertThat(tlsText.fragment, is(revApplicationData));
    }


}
